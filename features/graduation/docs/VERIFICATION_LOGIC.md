# 졸업요건 검증 로직 (Verification Logic)

이 문서는 졸업 요건 검증이 내부적으로 어떻게 수행되는지, 특히 **과목 분류**, **영역별 재조정(Rebalancing) 알고리즘**, 그리고 **세부 요건 검증**의 흐름을 설명합니다.

## 1. 검증 프로세스 개요 (Process Overview)

졸업 요건 검증은 `evaluateGraduationStatus` 함수(Engine)를 통해 수행되며, 크게 다음 4단계로 진행됩니다.

1.  **규정 로드 (Rule Loading)**: 입학년도에 맞는 졸업 요건(RuleSet)을 불러옵니다.
2.  **1차 과목 분류 (Classification)**: 수강한 과목을 과목 코드를 기준으로 1차 분류합니다 (전공, 부전공, 기초과학, 인문사회 등).
3.  **영역 재조정 (Rebalancing)**: 과목이 여러 영역에 걸쳐있거나 요건을 충족하고 남는 학점을 다른 영역으로 인정해주는 로직을 수행합니다. **(가장 중요한 알고리즘)**
4.  **세부 요건 검증 (Fine-Grained Check)**: 각 영역별로 필수 과목 이수 여부, 학점 충족 여부 등을 정밀하게 검사합니다.

---

## 2. 핵심 알고리즘: 영역 재조정 (Category Rebalancing)

단순히 과목 코드로 분류하는 것을 넘어, 졸업 요건을 최대화하기 위해 과목의 소속을 변경하는 과정입니다.

### A. 부전공 vs 기초과학 우선순위 (Minor vs Science Rebalancing)
부전공 과목이 기초과학 과목과 겹치는 경우 (예: 수학전공의 경우 미적분학), **기초과학 요건을 우선**으로 채웁니다.
- **논리**: 기초과학 필수(미적분학, 수학 탐색 등)를 먼저 확인하고, 필수 요건에 필요한 과목을 `기초과학`으로 분류합니다.
- **결과**: 기초과학 요건을 채우고 남은 과목만 `부전공` 학점으로 인정됩니다.

### B. 기초과학 3분야 시간순 선택 (Science 3-Field Selection)
기초과학 필수 요건 중 "수학 + (물리/화학/생명/SW 중 3분야)" 이수 요건을 검증하고, 선택되지 않은 분야의 과목은 `자유선택`으로 돌립니다.

1.  **시간순 정렬**: 모든 과학 과목을 수강 순서(학년/학기)대로 정렬합니다.
2.  **분야별 완료 확인**: 각 분야(물리/화학/생명/SW)별로 필수 요건(강의+실험 등)이 완료되었는지, 완료 시점이 언제인지 계산합니다.
    - *물리/화학/생명*: 강의와 실험을 모두 들어야 하며, **실험은 강의와 같거나 늦은 학기에 수강**해야 인정됩니다.
    - *SW*: 기초 필수 과목 이수 시 인정.
3.  **3분야 선정**:
    - **SW 이수 시**: SW + 가장 먼저 완료한 2개 분야를 선택.
    - **SW 미이수 시**: 가장 먼저 완료한 3개 분야를 선택.
4.  **분류**:
    - 선택된 3분야의 필수 과목 → `기초과학` 인정.
    - 선택되지 않은 분야의 과목 or 선택된 분야의 초과 과목 → `자유선택`으로 이동.

### C. 인문사회 잉여학점의 자유선택 인정 (Humanities Overflow)
인문사회 필수 학점(24학점)을 초과해서 수강한 경우, **최대 12학점**까지 `자유선택` 학점으로 인정해줍니다.
- **우선순위**: HUS(인문), PPE(사회) 필수 과목은 인문사회 영역에 남겨두고, 나머지(기타 인문 등)를 우선적으로 자유선택으로 보냅니다.

### D. 복수 인정 과목 처리 (Dual-Credit Course Handling)

> 상세 과목 목록: `DUAL_CREDIT_COURSES.md` 참조 (51개 과목)

동일 과목이 여러 학수번호(alias)로 개설되는 경우, **다중 영역에 동시 인정**되어야 합니다.

#### 문제 상황
- 예: `HS2544 (문화콘텐츠의 이해)` = `CT2544 (문화기술 부전공)`
- 학생이 HS2544 수강 시, 인문사회 학점으로만 분류되고 문화기술 부전공에는 미반영

#### 해결 알고리즘

**Step 1: Alias 확장 분류**
```
1. 수강 과목 코드로 course_db.csv 조회
2. alias_course_codes 필드에서 모든 동등 코드 추출
3. 각 코드에 해당하는 영역(전공, 부전공, 인문사회 등)을 모두 탐색
4. 과목을 해당하는 모든 영역에 동시 등록
```

**Step 2: 학점 중복 방지**
```
1. 총 이수학점 계산 시에는 과목당 1회만 카운트
2. 영역별 요건 충족 확인 시에는 각 영역에서 독립적으로 확인
3. 예: HS2544(3학점) → 인문사회 3학점 + 문화기술 부전공 3학점
        (단, 총 이수학점은 3학점으로 계산)
```

**Step 3: 우선순위 적용**
```
과목이 여러 영역에 속할 때 우선순위:
1. 필수 요건(전공필수, 기초필수) > 선택 요건
2. 전공 > 부전공 > 기초과학 > 인문사회 > 자유선택
3. 미충족 영역 우선 할당
```

#### 주요 Alias 매핑 예시

| 수강 코드 | Alias 코드 | 인정 영역 |
|---|---|---|
| HS2544 | CT2544 | 인문사회 + 문화기술 부전공 |
| EC4216 | AI4004 | EECS 전공 + AI융합 전공 |
| BS2104 | CH3106, EV3223 | 생명과학 + 화학 + 환경공학 |
| IR2202 | MC2103 | 지능로봇 부전공 + 기계로봇 전공 |

---

## 3. 영역별 세부 검증 (Area-Specific Verification)

재조정이 끝난 후, 각 영역별로 구체적인 요건을 검증합니다.

### 1) 언어의 기초 (Language)
- **영어 I**: GS1601 등 지정된 과목군 중 1과목.
- **영어 II**: GS1602 등 지정된 과목군 중 1과목.
- **글쓰기**: GS1511~1534 중 1과목.
- *판정*: 해당 과목 코드 집합에 포함된 과목이 있는지 확인.

### 2) 기초과학 (Science Basic)
- **필수 과목**: 미적분학 + 수학적 탐색(Core Math) 이수 여부.
- **SW 기초**: SW 기초 과목 이수 여부 (컴퓨터프로그래밍 과목으로 대체 인정).
- **학점 합계**: 위에서 재조정된 과목들의 학점 합계가 기준(17~18학점) 이상인지 확인.

### 3) 인문사회 (Humanities)
- **HUS**: HUS 코드로 지정된 과목 합계 6학점 이상.
- **PPE**: PPE 코드로 지정된 과목 합계 6학점 이상.
- **총 학점**: 인문사회 전체 24학점 이상.

### 4) 전공 및 부전공 (Major & Minor)
- **전공 필수**: 전공별로 지정된 필수 과목(또는 과목군 중 택N) 이수 여부 확인.
    - *예: 물리전공은 4대 역학 중 3개 이상 이수 등.*
- **학점**: 전공 36학점, 부전공 15학점 이상 여부.
- **전공 논문**: 학사논문연구 I, II 이수 여부 (전공 코드 + 9102/9103).

### 5) 기타 필수 (Mandatory / Examples)
- **전공탐색**: 2021학번 이후 UC0902 필수.
- **콜로퀴움**: GIST 대학 콜로퀴움 2회 이상.
- **과학기술과 경제**: GS1701 필수.
- **예체능**: 입학년도에 따라 예술/체육 각각 2과목 또는 4과목(10학번대) 이수.

### 6) 부전공 Alias 매핑 (Minor Alias Mapping)

부전공 이수 검증 시, 수강한 과목이 **alias 코드로 부전공 요건에 해당하는지** 추가 확인합니다.

#### 검증 로직
```
for each required_course in minor_requirements:
    # 직접 수강 확인
    if required_course.code in student.taken_courses:
        mark_as_satisfied(required_course)
        continue
    
    # Alias 매핑 확인
    aliases = course_db.get_aliases(required_course.code)
    for alias in aliases:
        if alias in student.taken_courses:
            mark_as_satisfied(required_course)
            break
```

#### 주요 부전공별 Alias 매핑

| 부전공 | 부전공 코드 | Alias 코드(인문사회 등) |
|---|---|---|
| 문화기술 | CT2544 | HS2544 (문화콘텐츠의 이해) |
| 문화기술 | CT2506 | HS2627 (신화와 원형상징) |
| 문화기술 | CT2501 | HS2707 (오타쿠 대중문화론) |
| 문화기술 | CT4201 | EC4215 (컴퓨터 그래픽스) |
| 지능로봇 | IR2202 | MC2103 (동역학) |
| 지능로봇 | IR3202 | MC3203, EC3219 (시스템 모델링 및 제어) |
| 지능로봇 | IR4201 | AI4311 (딥러닝) |

---

## 4. 최종 판정 (Final Decision)
모든 영역의 `satisfied`가 `true`이고, 총 이수학점이 130학점 이상이면 최종적으로 **졸업 가능**으로 판정합니다.
